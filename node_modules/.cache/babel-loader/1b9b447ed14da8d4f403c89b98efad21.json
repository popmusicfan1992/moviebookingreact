{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ADMIN/Desktop/BaiHocReactjs/reactjs_bai5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/ADMIN/Desktop/BaiHocReactjs/reactjs_bai5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{connection}from\"../../index\";import{quanLyDatVeService}from\"../../service/QuanLyDatVeService\";import{DISPLAY_LOADING,HIDE_LOADING}from\"../../util/settings/config\";import{CHUYEN_TAB,DAT_GHE,DAT_VE_HOAN_TAT,SET_CHI_TIET_PHONG_VE}from\"../types/QuanLyDatVeType\";import{thongTinTaiKhoanAction}from\"./QuanLyNguoiDungAction\";import Swal from'sweetalert2';export var layChiTietPhongVeAction=function layChiTietPhongVeAction(maLichChieu){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:DISPLAY_LOADING});_context.next=4;return quanLyDatVeService.layChiTietPhongVe(maLichChieu);case 4:result=_context.sent;if(!(result.status===200)){_context.next=8;break;}_context.next=8;return dispatch({type:SET_CHI_TIET_PHONG_VE,chiTietPhongVe:result.data.content});case 8:dispatch({type:HIDE_LOADING});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log('error',_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var datVeAction=function datVeAction(thongtinDatVe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch,getState){var result,userLogin;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;dispatch({type:DISPLAY_LOADING});_context2.next=4;return quanLyDatVeService.datVe(thongtinDatVe);case 4:result=_context2.sent;if(result.status===200){Swal.fire({text:'Đặt vé thành công thành công!',icon:'success',showCancelButton:false,confirmButtonText:'Ok'}).then(function(info){if(info.isConfirmed){dispatch({type:CHUYEN_TAB});}});;}_context2.next=8;return dispatch(layChiTietPhongVeAction(thongtinDatVe.maLichChieu));case 8:_context2.next=10;return dispatch({type:DAT_VE_HOAN_TAT});case 10:_context2.next=12;return dispatch({type:HIDE_LOADING});case 12:userLogin=getState().QuanLyNguoiDungReducer.userLogin;connection.invoke('datGheThanhCong',userLogin.taiKhoan,thongtinDatVe.maLichChieu);dispatch(thongTinTaiKhoanAction());_context2.next=21;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](0);Swal.fire({text:'Đặt vé thất bại!',icon:'error',showCancelButton:false,confirmButtonText:'Ok'}).then(function(info){});;case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[0,17]]);}));return function(_x2,_x3){return _ref2.apply(this,arguments);};}();};export var datGheAction=function datGheAction(ghe,maLichChieu){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch,getState){var danhSachGheDangDat,taiKhoan;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return dispatch({type:DAT_GHE,gheDuocChon:ghe});case 2://call api ve backend\ndanhSachGheDangDat=getState().QuanLyDatVeReducer.danhSachGheDangDat;taiKhoan=getState().QuanLyNguoiDungReducer.userLogin.taiKhoan;// console.log(\"danhSachGheDangDat\", danhSachGheDangDat);\n// console.log(\"malichchieu\", maLichChieu);\ndanhSachGheDangDat=JSON.stringify(danhSachGheDangDat);taiKhoan=taiKhoan.toString();//call api signalR\nconnection.invoke('datGhe',taiKhoan,danhSachGheDangDat,maLichChieu);case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4,_x5){return _ref3.apply(this,arguments);};}();};","map":{"version":3,"sources":["C:/Users/ADMIN/Desktop/BaiHocReactjs/reactjs_bai5/src/redux/actions/QuanLyDatVeAction.js"],"names":["connection","quanLyDatVeService","DISPLAY_LOADING","HIDE_LOADING","CHUYEN_TAB","DAT_GHE","DAT_VE_HOAN_TAT","SET_CHI_TIET_PHONG_VE","thongTinTaiKhoanAction","Swal","layChiTietPhongVeAction","maLichChieu","dispatch","type","layChiTietPhongVe","result","status","chiTietPhongVe","data","content","console","log","datVeAction","thongtinDatVe","getState","datVe","fire","text","icon","showCancelButton","confirmButtonText","then","info","isConfirmed","userLogin","QuanLyNguoiDungReducer","invoke","taiKhoan","datGheAction","ghe","gheDuocChon","danhSachGheDangDat","QuanLyDatVeReducer","JSON","stringify","toString"],"mappings":"6UAAA,OAASA,UAAT,KAA2B,aAA3B,CACA,OAASC,kBAAT,KAAmC,kCAAnC,CACA,OAASC,eAAT,CAA0BC,YAA1B,KAA8C,4BAA9C,CACA,OAASC,UAAT,CAAqBC,OAArB,CAA8BC,eAA9B,CAA+CC,qBAA/C,KAA4E,0BAA5E,CACA,OAASC,sBAAT,KAAuC,yBAAvC,CACA,MAAOC,CAAAA,IAAP,KAAiB,aAAjB,CAEA,MAAO,IAAMC,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,CAACC,WAAD,CAAiB,CACpD,+FAAO,iBAAOC,QAAP,6IAECA,QAAQ,CAAC,CACLC,IAAI,CAAEX,eADD,CAAD,CAAR,CAFD,sBAKsBD,CAAAA,kBAAkB,CAACa,iBAAnB,CAAqCH,WAArC,CALtB,QAKOI,MALP,oBAMKA,MAAM,CAACC,MAAP,GAAkB,GANvB,gDAOWJ,CAAAA,QAAQ,CAAC,CACXC,IAAI,CAAEN,qBADK,CAEXU,cAAc,CAAEF,MAAM,CAACG,IAAP,CAAYC,OAFjB,CAAD,CAPnB,QAYCP,QAAQ,CAAC,CAAEC,IAAI,CAAEV,YAAR,CAAD,CAAR,CAZD,iFAcCiB,OAAO,CAACC,GAAR,CAAY,OAAZ,cAdD,qEAAP,+DAiBH,CAlBM,CAmBP,MAAO,IAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,aAAD,CAAmB,CAC1C,gGAAO,kBAAOX,QAAP,CAAiBY,QAAjB,4JAGCZ,QAAQ,CAAC,CACLC,IAAI,CAAEX,eADD,CAAD,CAAR,CAHD,uBAMsBD,CAAAA,kBAAkB,CAACwB,KAAnB,CAAyBF,aAAzB,CANtB,QAMOR,MANP,gBAOC,GAAIA,MAAM,CAACC,MAAP,GAAkB,GAAtB,CAA2B,CACvBP,IAAI,CAACiB,IAAL,CAAU,CACNC,IAAI,CAAE,+BADA,CAENC,IAAI,CAAE,SAFA,CAGNC,gBAAgB,CAAE,KAHZ,CAINC,iBAAiB,CAAE,IAJb,CAAV,EAKGC,IALH,CAKQ,SAACC,IAAD,CAAU,CAEd,GAAIA,IAAI,CAACC,WAAT,CAAsB,CAClBrB,QAAQ,CAAC,CACLC,IAAI,CAAET,UADD,CAAD,CAAR,CAIH,CACJ,CAbD,EAaG,CACN,CAtBF,uBAuBOQ,CAAAA,QAAQ,CAACF,uBAAuB,CAACa,aAAa,CAACZ,WAAf,CAAxB,CAvBf,gCAwBOC,CAAAA,QAAQ,CAAC,CAAEC,IAAI,CAAEP,eAAR,CAAD,CAxBf,iCA2BOM,CAAAA,QAAQ,CAAC,CAAEC,IAAI,CAAEV,YAAR,CAAD,CA3Bf,SA4BK+B,SA5BL,CA4BiBV,QAAQ,GAAGW,sBAAX,CAAkCD,SA5BnD,CA6BClC,UAAU,CAACoC,MAAX,CAAkB,iBAAlB,CAAqCF,SAAS,CAACG,QAA/C,CAAyDd,aAAa,CAACZ,WAAvE,EACAC,QAAQ,CAACJ,sBAAsB,EAAvB,CAAR,CA9BD,qFAkCCC,IAAI,CAACiB,IAAL,CAAU,CACNC,IAAI,CAAE,kBADA,CAENC,IAAI,CAAE,OAFA,CAGNC,gBAAgB,CAAE,KAHZ,CAINC,iBAAiB,CAAE,IAJb,CAAV,EAKGC,IALH,CAKQ,SAACC,IAAD,CAAU,CACjB,CAND,EAMG,CAxCJ,uEAAP,qEA6CH,CA9CM,CAgDP,MAAO,IAAMM,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,GAAD,CAAM5B,WAAN,CAAsB,CAC9C,gGAAO,kBAAOC,QAAP,CAAiBY,QAAjB,6KAEGZ,CAAAA,QAAQ,CAAC,CACXC,IAAI,CAAER,OADK,CAEXmC,WAAW,CAAED,GAFF,CAAD,CAFX,QAMH;AACIE,kBAPD,CAOsBjB,QAAQ,GAAGkB,kBAAX,CAA8BD,kBAPpD,CAQCJ,QARD,CAQYb,QAAQ,GAAGW,sBAAX,CAAkCD,SAAlC,CAA4CG,QARxD,CASH;AACA;AACAI,kBAAkB,CAAGE,IAAI,CAACC,SAAL,CAAeH,kBAAf,CAArB,CACAJ,QAAQ,CAAGA,QAAQ,CAACQ,QAAT,EAAX,CACA;AACA7C,UAAU,CAACoC,MAAX,CAAkB,QAAlB,CAA4BC,QAA5B,CAAsCI,kBAAtC,CAA0D9B,WAA1D,EAdG,wDAAP,qEAgBH,CAjBM","sourcesContent":["import { connection } from \"../../index\";\r\nimport { quanLyDatVeService } from \"../../service/QuanLyDatVeService\";\r\nimport { DISPLAY_LOADING, HIDE_LOADING } from \"../../util/settings/config\";\r\nimport { CHUYEN_TAB, DAT_GHE, DAT_VE_HOAN_TAT, SET_CHI_TIET_PHONG_VE } from \"../types/QuanLyDatVeType\";\r\nimport { thongTinTaiKhoanAction } from \"./QuanLyNguoiDungAction\";\r\nimport Swal from 'sweetalert2';\r\n\r\nexport const layChiTietPhongVeAction = (maLichChieu) => {\r\n    return async (dispatch) => {\r\n        try {\r\n            dispatch({\r\n                type: DISPLAY_LOADING\r\n            });\r\n            const result = await quanLyDatVeService.layChiTietPhongVe(maLichChieu);\r\n            if (result.status === 200) {\r\n                await dispatch({\r\n                    type: SET_CHI_TIET_PHONG_VE,\r\n                    chiTietPhongVe: result.data.content\r\n                });\r\n            }\r\n            dispatch({ type: HIDE_LOADING });\r\n        } catch (error) {\r\n            console.log('error', error);\r\n        }\r\n    };\r\n};\r\nexport const datVeAction = (thongtinDatVe) => {\r\n    return async (dispatch, getState) => {\r\n\r\n        try {\r\n            dispatch({\r\n                type: DISPLAY_LOADING\r\n            });\r\n            const result = await quanLyDatVeService.datVe(thongtinDatVe);\r\n            if (result.status === 200) {\r\n                Swal.fire({\r\n                    text: 'Đặt vé thành công thành công!',\r\n                    icon: 'success',\r\n                    showCancelButton: false,\r\n                    confirmButtonText: 'Ok',\r\n                }).then((info) => {\r\n\r\n                    if (info.isConfirmed) {\r\n                        dispatch({\r\n                            type: CHUYEN_TAB\r\n                        });\r\n\r\n                    }\r\n                });;\r\n            }\r\n            await dispatch(layChiTietPhongVeAction(thongtinDatVe.maLichChieu));\r\n            await dispatch({ type: DAT_VE_HOAN_TAT });\r\n\r\n\r\n            await dispatch({ type: HIDE_LOADING });\r\n            let userLogin = getState().QuanLyNguoiDungReducer.userLogin;\r\n            connection.invoke('datGheThanhCong', userLogin.taiKhoan, thongtinDatVe.maLichChieu);\r\n            dispatch(thongTinTaiKhoanAction());\r\n\r\n\r\n        } catch (err) {\r\n            Swal.fire({\r\n                text: 'Đặt vé thất bại!',\r\n                icon: 'error',\r\n                showCancelButton: false,\r\n                confirmButtonText: 'Ok',\r\n            }).then((info) => {\r\n            });;\r\n\r\n        }\r\n\r\n    };\r\n};\r\n\r\nexport const datGheAction = (ghe, maLichChieu) => {\r\n    return async (dispatch, getState) => {\r\n        //đƯA THÔNG TIN LÊN REDUCER\r\n        await dispatch({\r\n            type: DAT_GHE,\r\n            gheDuocChon: ghe\r\n        });\r\n        //call api ve backend\r\n        let danhSachGheDangDat = getState().QuanLyDatVeReducer.danhSachGheDangDat;\r\n        let taiKhoan = getState().QuanLyNguoiDungReducer.userLogin.taiKhoan;\r\n        // console.log(\"danhSachGheDangDat\", danhSachGheDangDat);\r\n        // console.log(\"malichchieu\", maLichChieu);\r\n        danhSachGheDangDat = JSON.stringify(danhSachGheDangDat);\r\n        taiKhoan = taiKhoan.toString();\r\n        //call api signalR\r\n        connection.invoke('datGhe', taiKhoan, danhSachGheDangDat, maLichChieu);\r\n    };\r\n};"]},"metadata":{},"sourceType":"module"}