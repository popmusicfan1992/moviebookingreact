{"ast":null,"code":"import _objectSpread from\"C:/Users/ADMIN/Desktop/BaiHocReactjs/reactjs_bai5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/Users/ADMIN/Desktop/BaiHocReactjs/reactjs_bai5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React,{Fragment,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{datGheAction,datVeAction,layChiTietPhongVeAction}from'../../redux/actions/QuanLyDatVeAction';import{CloseOutlined,UserOutlined,CheckOutlined,AppleOutlined,AndroidOutlined,HomeOutlined,DollarCircleOutlined,HistoryOutlined}from'@ant-design/icons';import{Tabs,Pagination,Button,Divider,Checkbox}from'antd';import style from'./Checkout.module.css';import'./Checkout.css';import _ from'lodash';import{useTranslation}from'react-i18next';import{CHUYEN_TAB,DAT_GHE}from'../../redux/types/QuanLyDatVeType';import{thongTinTaiKhoanAction}from'../../redux/actions/QuanLyNguoiDungAction';import moment from'moment';import{connection}from'../../index';import{history}from'../../App';import{TOKEN,USER_LOGIN}from'../../util/settings/config';import{NavLink}from'react-router-dom';import Home from'../Home/Home';import Swal from'sweetalert2';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Checkout(props){var _useSelector=useSelector(function(state){return state.QuanLyNguoiDungReducer;}),userLogin=_useSelector.userLogin,thongTinTaiKhoan=_useSelector.thongTinTaiKhoan;var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useSelector2=useSelector(function(state){return state.QuanLyDatVeReducer;}),chiTietPhongVe=_useSelector2.chiTietPhongVe,danhSachGheDangDat=_useSelector2.danhSachGheDangDat,danhSachGheKhachDat=_useSelector2.danhSachGheKhachDat;var thongTinPhim=chiTietPhongVe.thongTinPhim,danhSachGhe=chiTietPhongVe.danhSachGhe;var dispatch=useDispatch();var renderSeats=function renderSeats(){return danhSachGhe===null||danhSachGhe===void 0?void 0:danhSachGhe.map(function(ghe,index){var classGheVip=ghe.loaiGhe==='Vip'?'gheVip':'';var classGheDaDat=ghe.daDat===true?'gheDaDat':'';var classGheDangDat='';var indexGheDD=danhSachGheDangDat.findIndex(function(gheDD){return gheDD.maGhe===ghe.maGhe;});if(indexGheDD!=-1){classGheDaDat='gheDangDat';}var classGheCuaMinh='';if(userLogin.taiKhoan===ghe.taiKhoanNguoiDat){classGheCuaMinh='gheCuaMinh';}//Kiểm tra ghế có được người khác đang đặt ko\nvar classGheKhachDat='';var indexGheKhachDat=danhSachGheKhachDat.findIndex(function(gheKD){return gheKD.maGhe===ghe.maGhe;});if(indexGheKhachDat!=-1){classGheKhachDat='gheKhachDat';}return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"button\",{disabled:ghe.daDat|classGheKhachDat!='',className:\"ghe font-semibold \".concat(classGheVip,\" \").concat(classGheDaDat,\" \").concat(classGheDangDat).concat(classGheCuaMinh,\" \").concat(classGheKhachDat),onClick:function onClick(){dispatch(datGheAction(ghe,props.match.params.id));},children:ghe.taiKhoanNguoiDat===userLogin.taiKhoan?/*#__PURE__*/_jsx(UserOutlined,{}):ghe.daDat?/*#__PURE__*/_jsx(CloseOutlined,{}):ghe.stt},index)},index);});};useEffect(function(){dispatch(thongTinTaiKhoanAction());dispatch(layChiTietPhongVeAction(props.match.params.id));//vừa vào trang load tất cả ghế của các người khcas đnag đặt\nconnection.invoke('loadDanhSachGhe',props.match.params.id);//Có 1 client nào đó thực hiện đặt vé thành công mình sẽ load lại danh sách phòng vé của lịch chiếu đó\nconnection.on('datVeThanhCong',function(){dispatch(layChiTietPhongVeAction(props.match.params.id));});//loading dánh sách ghế đang đặt từ server về\nconnection.on(\"loadDanhSachGheDaDat\",function(dsGheKhachDat){dsGheKhachDat=dsGheKhachDat.filter(function(item){return item.taiKhoan!==userLogin.taiKhoan;});// console.log(\"dsGheKhachDat Filter\", dsGheKhachDat);\n//Bước 2 dùng reduce vì reduce ko làm vs những cái ko có giá trị\nvar arrGheKhachDat=dsGheKhachDat.reduce(function(result,item,index){var arrGhe=JSON.parse(item.danhSachGhe);return[].concat(_toConsumableArray(result),_toConsumableArray(arrGhe));},[]);// console.log(\"arrGheKhachDat reduce\", arrGheKhachDat);\narrGheKhachDat=_.uniqBy(arrGheKhachDat,'maGhe');dispatch({type:'GHE_KHACH_DAT',arrGheKhachDat:arrGheKhachDat});//load lai trang\nwindow.addEventListener(\"beforeunload\",clearGhe);//component unmount ( khi bam qua trang khac)\nreturn function(){clearGhe();window.removeEventListener('beforeunload',clearGhe);};});},[]);var clearGhe=function clearGhe(event){connection.invoke('huyDat',userLogin.taiKhoan,props.match.params.id);};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen mt-5 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-9 col-span-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-black\",style:{width:'80%',height:15}}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(style['trapezoid'],\" text-center\"),children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-gray-900 mt-3\",children:t('checkout.manhinh')})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid md:grid-cols-12 grid-cols-6\",children:renderSeats()}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-5 flex justify-center w-full\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 p-5\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t('checkout.ghechuadat')}),/*#__PURE__*/_jsx(\"th\",{children:t('checkout.ghedangdat')}),/*#__PURE__*/_jsx(\"th\",{children:t('checkout.ghevip')}),/*#__PURE__*/_jsx(\"th\",{children:t('checkout.ghedaduocdat')}),/*#__PURE__*/_jsx(\"th\",{children:t('checkout.ghecuabandat')}),/*#__PURE__*/_jsx(\"th\",{children:t('checkout.ghenguoikhacdat')})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"ghe\",children:/*#__PURE__*/_jsx(CheckOutlined,{})})}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"ghe gheDangDat\",children:/*#__PURE__*/_jsx(CheckOutlined,{})})}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"ghe gheVip\",children:/*#__PURE__*/_jsx(CheckOutlined,{})})}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"ghe gheDaDat\",children:[\" \",/*#__PURE__*/_jsx(CloseOutlined,{})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"ghe gheCuaMinh\",children:[\" \",/*#__PURE__*/_jsx(UserOutlined,{})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"ghe gheKhachDat\",children:[\" \",/*#__PURE__*/_jsx(CheckOutlined,{})]})})]})})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-3 col-span-12 font-semibold \",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-green-400 text-center text-2xl\",children:[\" \",danhSachGheDangDat.reduce(function(tongTien,ghe,index){return tongTien+=ghe.giaVe;},0).toLocaleString(),\" VND\"]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl mt-2\",children:thongTinPhim===null||thongTinPhim===void 0?void 0:thongTinPhim.tenPhim}),/*#__PURE__*/_jsxs(\"p\",{children:[t('checkout.diadiem'),\": \",thongTinPhim===null||thongTinPhim===void 0?void 0:thongTinPhim.diaChi]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('detail.ngaykhoichieu'),\": \",thongTinPhim===null||thongTinPhim===void 0?void 0:thongTinPhim.ngayChieu,\" - \",thongTinPhim===null||thongTinPhim===void 0?void 0:thongTinPhim.gioChieu,\" \",thongTinPhim===null||thongTinPhim===void 0?void 0:thongTinPhim.tenRap]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 my-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-span-2\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-400 text-lg mr-2\",children:[t('checkout.ghe'),\":\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-span-2\",children:_.sortBy(danhSachGheDangDat,['stt']).map(function(gheDD,index){return/*#__PURE__*/_jsx(\"span\",{className:\"text-green-500 text-xl ml-2\",children:gheDD.stt},index);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-1 text-right text-green-400 text-lg\",children:[danhSachGheDangDat.reduce(function(tongTien,ghe,index){return tongTien+=ghe.giaVe;},0).toLocaleString(),\" VND\"]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-5\",children:[/*#__PURE__*/_jsx(\"i\",{children:t('profile.email')}),\" \",/*#__PURE__*/_jsx(\"br\",{}),userLogin.email]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-5\",children:[/*#__PURE__*/_jsx(\"i\",{children:t('profile.sodienthoai')}),\" \",/*#__PURE__*/_jsx(\"br\",{}),thongTinTaiKhoan===null||thongTinTaiKhoan===void 0?void 0:thongTinTaiKhoan.soDT]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"\",style:{marginBottom:0},children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-500 text-white w-full text-center py-3 font-bold text-2xl cursor-pointer\",onClick:function onClick(){var thongtinDatVe={maLichChieu:props.match.params.id,danhSachVe:danhSachGheDangDat};Swal.fire({icon:'question',title:'Đặt vé!',text:\"B\\u1EA1n c\\xF3 mu\\u1ED1n \\u0111\\u1EB7t v\\xE9 phim n\\xE0y kh\\xF4ng!\",showCancelButton:true,confirmButtonText:'Đặt',cancelButtonText:'Không'}).then(function(info){if(info.isConfirmed){dispatch(datVeAction(thongtinDatVe));}});},children:t('booking')})})]})]})});}function Ketqua(props){var _useTranslation2=useTranslation(),t=_useTranslation2.t,i18n=_useTranslation2.i18n;var dispatch=useDispatch();var _useSelector3=useSelector(function(state){return state.QuanLyNguoiDungReducer;}),thongTinTaiKhoan=_useSelector3.thongTinTaiKhoan,userLogin=_useSelector3.userLogin;useEffect(function(){dispatch(thongTinTaiKhoanAction());},[]);var renderLichSuDatVe=function renderLichSuDatVe(){var _thongTinTaiKhoan$tho;return(_thongTinTaiKhoan$tho=thongTinTaiKhoan.thongTinDatVe)===null||_thongTinTaiKhoan$tho===void 0?void 0:_thongTinTaiKhoan$tho.map(function(ve,index){return/*#__PURE__*/_jsx(\"div\",{className:\"p-2 lg:w-1/3 md:w-1/2 w-full\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex items-center border-gray-200 border p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"img\",{alt:\"team\",className:\"w-16 h-16 bg-gray-100 object-cover object-center flex-shrink-0 rounded-full mr-4\",src:ve.hinhAnh,onError:function onError(e){e.target.src='/images/movies/end-game.jpg';}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-yellow-800 title-font font-medium text-xl\",children:ve.tenPhim}),/*#__PURE__*/_jsxs(\"p\",{children:[t('detail.ngaykhoichieu'),\": \",moment(ve.ngayDat).format('hh:mm A - DD-MM-YYYY')]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-500 mb-0\",children:[t('result.mave'),\": \",ve.maVe]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-500\",children:[t('result.giave'),\": \",ve.giaVe]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('result.tenhethongrap'),\": \",_.first(ve.danhSachGhe).tenHeThongRap]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('result.tencumrap'),\": \",_.first(ve.danhSachGhe).tenCumRap]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('result.tenghe'),\": \",ve.danhSachGhe.map(function(ghe,index){return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-red-600\",children:ghe.tenGhe}),(index+1)%7===0?/*#__PURE__*/_jsx(\"br\",{}):'']});})]})]})]})},index);});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"section\",{className:\"text-gray-600 body-font result-ticket\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container px-5 py-24 mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col text-center w-full mb-20\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"sm:text-3xl text-2xl font-medium title-font mb-4 text-purple-600\",children:[t('result.lichsu'),\" \"]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('profile.sodienthoai'),\" : \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-500\",children:userLogin.hoTen})]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('profile.email'),\" : \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-500\",children:userLogin.email})]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('profile.sodienthoai'),\" : \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-500\",children:userLogin.soDT})]}),/*#__PURE__*/_jsx(\"p\",{className:\"lg:w-2/3 mx-auto leading-relaxed text-base\",children:t('result.good')})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap -m-2\",children:renderLichSuDatVe()})]})}),\";\"]});}var TabPane=Tabs.TabPane;export default function(props){var _useTranslation3=useTranslation(),t=_useTranslation3.t,i18n=_useTranslation3.i18n;var _useSelector4=useSelector(function(state){return state.QuanLyDatVeReducer;}),tabActive=_useSelector4.tabActive;var _useSelector5=useSelector(function(state){return state.QuanLyNguoiDungReducer;}),userLogin=_useSelector5.userLogin;var dispatch=useDispatch();function callback(key){dispatch({type:\"CHANGE_TAB\",key:key});}useEffect(function(){return function(){dispatch({type:\"CHANGE_TAB\",key:'1'});};},[]);var operations=/*#__PURE__*/_jsx(Fragment,{children:!_.isEmpty(userLogin)?/*#__PURE__*/_jsxs(Fragment,{children:[\" \",/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){history.push('/profile');},children:[\" \",/*#__PURE__*/_jsx(\"div\",{style:{width:50,height:50,display:'flex',justifyContent:'center',alignItems:'center'},className:\"text-2xl ml-5 rounded-full bg-red-200\",children:userLogin.taiKhoan.substr(0,1)}),\"Hello ! \",userLogin.taiKhoan]}),\" \",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){localStorage.removeItem(USER_LOGIN);localStorage.removeItem(TOKEN);history.push('/home');window.location.reload();},className:\"text-blue-800\",children:t('profile.dangxuat')}),\" \"]}):''});return/*#__PURE__*/_jsx(\"div\",{className:\"p-5\",children:/*#__PURE__*/_jsxs(Tabs,{tabBarExtraContent:operations,activeKey:tabActive,onChange:callback,children:[/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(DollarCircleOutlined,{}),\"01 \",t('checkout.menu1')]}),children:/*#__PURE__*/_jsx(Checkout,_objectSpread({},props))},\"1\"),/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(HistoryOutlined,{}),\"02 \",t('checkout.menu2')]}),children:/*#__PURE__*/_jsx(Ketqua,_objectSpread({},props))},\"2\"),/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{onClick:function onClick(){history.push('/');},children:[/*#__PURE__*/_jsx(HomeOutlined,{}),t('home')]})})]})});}","map":{"version":3,"sources":["C:/Users/ADMIN/Desktop/BaiHocReactjs/reactjs_bai5/src/pages/Checkout/Checkout.js"],"names":["React","Fragment","useEffect","useDispatch","useSelector","datGheAction","datVeAction","layChiTietPhongVeAction","CloseOutlined","UserOutlined","CheckOutlined","AppleOutlined","AndroidOutlined","HomeOutlined","DollarCircleOutlined","HistoryOutlined","Tabs","Pagination","Button","Divider","Checkbox","style","_","useTranslation","CHUYEN_TAB","DAT_GHE","thongTinTaiKhoanAction","moment","connection","history","TOKEN","USER_LOGIN","NavLink","Home","Swal","Checkout","props","state","QuanLyNguoiDungReducer","userLogin","thongTinTaiKhoan","t","i18n","QuanLyDatVeReducer","chiTietPhongVe","danhSachGheDangDat","danhSachGheKhachDat","thongTinPhim","danhSachGhe","dispatch","renderSeats","map","ghe","index","classGheVip","loaiGhe","classGheDaDat","daDat","classGheDangDat","indexGheDD","findIndex","gheDD","maGhe","classGheCuaMinh","taiKhoan","taiKhoanNguoiDat","classGheKhachDat","indexGheKhachDat","gheKD","match","params","id","stt","invoke","on","dsGheKhachDat","filter","item","arrGheKhachDat","reduce","result","arrGhe","JSON","parse","uniqBy","type","window","addEventListener","clearGhe","removeEventListener","event","width","height","tongTien","giaVe","toLocaleString","tenPhim","diaChi","ngayChieu","gioChieu","tenRap","sortBy","email","soDT","marginBottom","thongtinDatVe","maLichChieu","danhSachVe","fire","icon","title","text","showCancelButton","confirmButtonText","cancelButtonText","then","info","isConfirmed","Ketqua","renderLichSuDatVe","thongTinDatVe","ve","hinhAnh","e","target","src","ngayDat","format","maVe","first","tenHeThongRap","tenCumRap","tenGhe","hoTen","TabPane","tabActive","callback","key","operations","isEmpty","push","display","justifyContent","alignItems","substr","localStorage","removeItem","location","reload"],"mappings":"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","sourcesContent":["import React, { Fragment, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { datGheAction, datVeAction, layChiTietPhongVeAction } from '../../redux/actions/QuanLyDatVeAction';\r\nimport { CloseOutlined, UserOutlined, CheckOutlined, AppleOutlined, AndroidOutlined, HomeOutlined, DollarCircleOutlined, HistoryOutlined } from '@ant-design/icons';\r\nimport { Tabs, Pagination, Button, Divider, Checkbox } from 'antd';\r\nimport style from './Checkout.module.css';\r\nimport './Checkout.css';\r\nimport _ from 'lodash';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { CHUYEN_TAB, DAT_GHE } from '../../redux/types/QuanLyDatVeType';\r\nimport { thongTinTaiKhoanAction } from '../../redux/actions/QuanLyNguoiDungAction';\r\nimport moment from 'moment';\r\nimport { connection } from '../../index';\r\nimport { history } from '../../App';\r\nimport { TOKEN, USER_LOGIN } from '../../util/settings/config';\r\nimport { NavLink } from 'react-router-dom';\r\nimport Home from '../Home/Home';\r\nimport Swal from 'sweetalert2';\r\nfunction Checkout(props) {\r\n    const { userLogin, thongTinTaiKhoan } = useSelector(state => state.QuanLyNguoiDungReducer);\r\n    const { t, i18n } = useTranslation();\r\n\r\n    const { chiTietPhongVe, danhSachGheDangDat, danhSachGheKhachDat } = useSelector(state => state.QuanLyDatVeReducer);\r\n    const { thongTinPhim, danhSachGhe } = chiTietPhongVe;\r\n    const dispatch = useDispatch();\r\n\r\n\r\n    const renderSeats = () => {\r\n        return danhSachGhe?.map((ghe, index) => {\r\n            let classGheVip = ghe.loaiGhe === 'Vip' ? 'gheVip' : '';\r\n            let classGheDaDat = ghe.daDat === true ? 'gheDaDat' : '';\r\n            let classGheDangDat = '';\r\n            let indexGheDD = danhSachGheDangDat.findIndex(gheDD => gheDD.maGhe === ghe.maGhe);\r\n            if (indexGheDD != -1) {\r\n                classGheDaDat = 'gheDangDat';\r\n            }\r\n            let classGheCuaMinh = '';\r\n            if (userLogin.taiKhoan === ghe.taiKhoanNguoiDat) {\r\n                classGheCuaMinh = 'gheCuaMinh';\r\n            }\r\n            //Kiểm tra ghế có được người khác đang đặt ko\r\n            let classGheKhachDat = '';\r\n            let indexGheKhachDat = danhSachGheKhachDat.findIndex(gheKD => gheKD.maGhe === ghe.maGhe);\r\n            if (indexGheKhachDat != -1) {\r\n                classGheKhachDat = 'gheKhachDat';\r\n            }\r\n            return <Fragment key={index}>\r\n\r\n                <button disabled={ghe.daDat | classGheKhachDat != ''} className={`ghe font-semibold ${classGheVip} ${classGheDaDat} ${classGheDangDat}${classGheCuaMinh} ${classGheKhachDat}`} key={index} onClick={() => {\r\n                    dispatch(datGheAction(ghe, props.match.params.id));\r\n                }}>\r\n                    {ghe.taiKhoanNguoiDat === userLogin.taiKhoan ? <UserOutlined /> : ghe.daDat ? <CloseOutlined /> : ghe.stt}\r\n                </button>\r\n\r\n            </Fragment>;\r\n        });\r\n    };\r\n    useEffect(() => {\r\n        dispatch(thongTinTaiKhoanAction());\r\n        dispatch(layChiTietPhongVeAction(props.match.params.id));\r\n\r\n        //vừa vào trang load tất cả ghế của các người khcas đnag đặt\r\n        connection.invoke('loadDanhSachGhe', props.match.params.id);\r\n        //Có 1 client nào đó thực hiện đặt vé thành công mình sẽ load lại danh sách phòng vé của lịch chiếu đó\r\n        connection.on('datVeThanhCong', () => {\r\n            dispatch(layChiTietPhongVeAction(props.match.params.id));\r\n        });\r\n\r\n        //loading dánh sách ghế đang đặt từ server về\r\n        connection.on(\"loadDanhSachGheDaDat\", (dsGheKhachDat) => {\r\n            dsGheKhachDat = dsGheKhachDat.filter(item => item.taiKhoan !== userLogin.taiKhoan);\r\n            // console.log(\"dsGheKhachDat Filter\", dsGheKhachDat);\r\n            //Bước 2 dùng reduce vì reduce ko làm vs những cái ko có giá trị\r\n            let arrGheKhachDat = dsGheKhachDat.reduce((result, item, index) => {\r\n                let arrGhe = JSON.parse(item.danhSachGhe);\r\n                return [ ...result, ...arrGhe ];\r\n            }, []);\r\n            // console.log(\"arrGheKhachDat reduce\", arrGheKhachDat);\r\n            arrGheKhachDat = _.uniqBy(arrGheKhachDat, 'maGhe');\r\n            dispatch({\r\n                type: 'GHE_KHACH_DAT',\r\n                arrGheKhachDat\r\n            });\r\n            //load lai trang\r\n            window.addEventListener(\"beforeunload\", clearGhe);\r\n\r\n            //component unmount ( khi bam qua trang khac)\r\n            return () => {\r\n                clearGhe();\r\n                window.removeEventListener('beforeunload', clearGhe);\r\n            };\r\n\r\n        });\r\n    }, []);\r\n    const clearGhe = function (event) {\r\n        connection.invoke('huyDat', userLogin.taiKhoan, props.match.params.id);\r\n    };\r\n    return (\r\n        <div className='min-h-screen mt-5 '>\r\n            <div className='grid grid-cols-12'>\r\n                <div className='md:col-span-9 col-span-12'>\r\n                    <div className='flex flex-col items-center mt-5'>\r\n                        <div className='bg-black' style={{ width: '80%', height: 15 }}>\r\n\r\n                        </div>\r\n                        <div className={`${style[ 'trapezoid' ]} text-center`}>\r\n                            <h1 className='text-gray-900 mt-3' >{t('checkout.manhinh')}</h1>\r\n                        </div>\r\n                        <div className='grid md:grid-cols-12 grid-cols-6'>\r\n                            {renderSeats()}\r\n                        </div>\r\n                        <div className='mt-5 flex justify-center w-full'>\r\n                            <table className=\"min-w-full divide-y divide-gray-200\">\r\n                                <thead className=\"bg-gray-50 p-5\">\r\n                                    <tr>\r\n                                        <th>{t('checkout.ghechuadat')}</th>\r\n                                        <th>{t('checkout.ghedangdat')}</th>\r\n                                        <th>{t('checkout.ghevip')}</th>\r\n                                        <th>{t('checkout.ghedaduocdat')}</th>\r\n                                        <th>{t('checkout.ghecuabandat')}</th>\r\n                                        <th>{t('checkout.ghenguoikhacdat')}</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                                    <tr>\r\n                                        <td className='text-center'>\r\n                                            <button className='ghe'><CheckOutlined /></button>\r\n                                        </td>\r\n                                        <td className='text-center'>\r\n                                            <button className='ghe gheDangDat'><CheckOutlined /></button>\r\n                                        </td>\r\n                                        <td className='text-center'>\r\n                                            <button className='ghe gheVip'><CheckOutlined /></button>\r\n                                        </td>\r\n                                        <td className='text-center'>\r\n                                            <button className='ghe gheDaDat'> <CloseOutlined /></button>\r\n                                        </td>\r\n                                        <td className='text-center'>\r\n                                            <button className='ghe gheCuaMinh'> <UserOutlined /></button>\r\n                                        </td>\r\n                                        <td className='text-center'>\r\n                                            <button className='ghe gheKhachDat'> <CheckOutlined /></button>\r\n                                        </td>\r\n\r\n                                    </tr>\r\n                                </tbody>\r\n                            </table>\r\n\r\n\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className='md:col-span-3 col-span-12 font-semibold '>\r\n                    <h3 className='text-green-400 text-center text-2xl'> {danhSachGheDangDat.reduce((tongTien, ghe, index) => {\r\n                        return tongTien += ghe.giaVe;\r\n                    }, 0).toLocaleString()} VND</h3>\r\n                    <hr />\r\n                    <h3 className='text-xl mt-2'>{thongTinPhim?.tenPhim}</h3>\r\n                    <p>{t('checkout.diadiem')}: {thongTinPhim?.diaChi}</p>\r\n                    <p>{t('detail.ngaykhoichieu')}: {thongTinPhim?.ngayChieu} - {thongTinPhim?.gioChieu} {thongTinPhim?.tenRap}</p>\r\n                    <hr />\r\n                    <div className='grid grid-cols-2 my-5'>\r\n                        <div className='col-span-2'>\r\n                            <span className='text-red-400 text-lg mr-2'>{t('checkout.ghe')}:</span>\r\n\r\n                        </div>\r\n                        <div className='col-span-2'>\r\n                            {_.sortBy(danhSachGheDangDat, [ 'stt' ]).map((gheDD, index) => {\r\n                                return <span key={index} className='text-green-500 text-xl ml-2'>\r\n                                    {gheDD.stt}\r\n                                </span>;\r\n                            })}\r\n                        </div>\r\n                        <div className='col-span-1 text-right text-green-400 text-lg'>\r\n                            {danhSachGheDangDat.reduce((tongTien, ghe, index) => {\r\n                                return tongTien += ghe.giaVe;\r\n                            }, 0).toLocaleString()} VND\r\n                        </div>\r\n                    </div>\r\n                    <hr />\r\n                    <div className='my-5'>\r\n                        <i>{t('profile.email')}</i> <br />\r\n                        {userLogin.email}\r\n                    </div>\r\n                    <hr />\r\n                    <div className='my-5'>\r\n                        <i>{t('profile.sodienthoai')}</i> <br />\r\n                        {thongTinTaiKhoan?.soDT}\r\n                    </div>\r\n                    <hr />\r\n                    <div className='' style={{ marginBottom: 0 }}>\r\n                        <div className='bg-green-500 text-white w-full text-center py-3 font-bold text-2xl cursor-pointer' onClick={() => {\r\n                            let thongtinDatVe = {\r\n                                maLichChieu: props.match.params.id,\r\n                                danhSachVe: danhSachGheDangDat\r\n                            };\r\n                            Swal.fire({\r\n                                icon: 'question',\r\n                                title: 'Đặt vé!',\r\n                                text: `Bạn có muốn đặt vé phim này không!`,\r\n                                showCancelButton: true,\r\n                                confirmButtonText: 'Đặt',\r\n                                cancelButtonText: 'Không'\r\n                            }).then((info) => {\r\n                                if (info.isConfirmed) {\r\n                                    dispatch(datVeAction(thongtinDatVe));\r\n                                }\r\n\r\n                            });\r\n\r\n\r\n                        }}>\r\n                            {t('booking')}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nfunction Ketqua(props) {\r\n    const { t, i18n } = useTranslation();\r\n    const dispatch = useDispatch();\r\n    const { thongTinTaiKhoan, userLogin } = useSelector(state => state.QuanLyNguoiDungReducer);\r\n    useEffect(() => {\r\n        dispatch(thongTinTaiKhoanAction());\r\n    }, []);\r\n    const renderLichSuDatVe = () => {\r\n        return thongTinTaiKhoan.thongTinDatVe?.map((ve, index) => {\r\n            return <div className=\"p-2 lg:w-1/3 md:w-1/2 w-full\" key={index}>\r\n                <div className=\"h-full flex items-center border-gray-200 border p-4 rounded-lg\">\r\n                    <img alt=\"team\" className=\"w-16 h-16 bg-gray-100 object-cover object-center flex-shrink-0 rounded-full mr-4\" src={ve.hinhAnh} onError={(e) => {\r\n                        e.target.src = '/images/movies/end-game.jpg';\r\n                    }} />\r\n                    <div className=\"flex-grow\">\r\n                        <h2 className=\"text-yellow-800 title-font font-medium text-xl\">{ve.tenPhim}</h2>\r\n                        <p>{t('detail.ngaykhoichieu')}: {moment(ve.ngayDat).format('hh:mm A - DD-MM-YYYY')}</p>\r\n                        <p className=\"text-gray-500 mb-0\">{t('result.mave')}: {ve.maVe}</p>\r\n                        <p className=\"text-gray-500\">{t('result.giave')}: {ve.giaVe}</p>\r\n                        <p>{t('result.tenhethongrap')}: {_.first(ve.danhSachGhe).tenHeThongRap}</p>\r\n                        <p>{t('result.tencumrap')}: {_.first(ve.danhSachGhe).tenCumRap}</p>\r\n                        <p>{t('result.tenghe')}: {ve.danhSachGhe.map((ghe, index) => {\r\n                            return <Fragment>\r\n                                <span className='ml-2 text-red-600'>{ghe.tenGhe}</span>\r\n                                {(index + 1) % 7 === 0 ? <br /> : ''}\r\n                            </Fragment>;\r\n                        })}</p>\r\n                    </div>\r\n                </div>\r\n            </div>;\r\n        });\r\n    };\r\n    return <div>\r\n        <section className=\"text-gray-600 body-font result-ticket\">\r\n            <div className=\"container px-5 py-24 mx-auto\">\r\n                <div className=\"flex flex-col text-center w-full mb-20\">\r\n                    <h1 className=\"sm:text-3xl text-2xl font-medium title-font mb-4 text-purple-600\">{t('result.lichsu')} </h1>\r\n                    <p>{t('profile.sodienthoai')} : <span className='text-green-500'>{userLogin.hoTen}</span></p>\r\n                    <p>{t('profile.email')} : <span className='text-green-500'>{userLogin.email}</span></p>\r\n                    <p>{t('profile.sodienthoai')} : <span className='text-green-500'>{userLogin.soDT}</span></p>\r\n                    <p className=\"lg:w-2/3 mx-auto leading-relaxed text-base\">{t('result.good')}</p>\r\n                </div>\r\n                <div className=\"flex flex-wrap -m-2\">\r\n                    {renderLichSuDatVe()}\r\n\r\n                </div>\r\n            </div>\r\n        </section>;\r\n    </div>;\r\n\r\n}\r\n\r\n\r\nconst { TabPane } = Tabs;\r\nexport default function (props) {\r\n    const { t, i18n } = useTranslation();\r\n    const { tabActive } = useSelector(state => state.QuanLyDatVeReducer);\r\n    const { userLogin } = useSelector(state => state.QuanLyNguoiDungReducer);\r\n    const dispatch = useDispatch();\r\n    function callback(key) {\r\n        dispatch({\r\n            type: \"CHANGE_TAB\",\r\n            key\r\n        });\r\n    }\r\n    useEffect(() => {\r\n\r\n        return () => {\r\n            dispatch({\r\n                type: \"CHANGE_TAB\",\r\n                key: '1'\r\n            });\r\n        };\r\n    }, []);\r\n    const operations = <Fragment>\r\n\r\n        {!_.isEmpty(userLogin) ? <Fragment> <button onClick={() => {\r\n            history.push('/profile');\r\n        }}> <div style={{ width: 50, height: 50, display: 'flex', justifyContent: 'center', alignItems: 'center' }} className=\"text-2xl ml-5 rounded-full bg-red-200\">{userLogin.taiKhoan.substr(0, 1)}</div>Hello ! {userLogin.taiKhoan}</button> <button onClick={() => {\r\n            localStorage.removeItem(USER_LOGIN);\r\n            localStorage.removeItem(TOKEN);\r\n            history.push('/home');\r\n            window.location.reload();\r\n        }} className=\"text-blue-800\">{t('profile.dangxuat')}</button> </Fragment> : ''}\r\n\r\n    </Fragment>;\r\n    return <div className='p-5'>\r\n        <Tabs tabBarExtraContent={operations} activeKey={tabActive} onChange={callback}>\r\n            <TabPane\r\n\r\n                tab={\r\n                    <span>\r\n                        <DollarCircleOutlined />\r\n                        01 {t('checkout.menu1')}\r\n                    </span>\r\n                }\r\n                key=\"1\"\r\n            >\r\n                <Checkout {...props} />\r\n            </TabPane>\r\n            <TabPane\r\n\r\n                tab={\r\n                    <span>\r\n                        <HistoryOutlined />\r\n                        02 {t('checkout.menu2')}\r\n                    </span>\r\n                }\r\n                key=\"2\"\r\n            >\r\n                <Ketqua {...props} />\r\n            </TabPane>\r\n            <TabPane\r\n                tab={\r\n                    <span onClick={() => {\r\n                        history.push('/');\r\n                    }}>\r\n                        <HomeOutlined />\r\n                        {t('home')}\r\n                    </span>\r\n                }\r\n\r\n            >\r\n\r\n            </TabPane>\r\n        </Tabs>\r\n    </div>;\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}