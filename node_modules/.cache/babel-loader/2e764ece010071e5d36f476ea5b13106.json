{"ast":null,"code":"import { connection } from \"../../index\";\nimport { quanLyDatVeService } from \"../../service/QuanLyDatVeService\";\nimport { DISPLAY_LOADING, HIDE_LOADING } from \"../../util/settings/config\";\nimport { CHUYEN_TAB, DAT_GHE, DAT_VE_HOAN_TAT, SET_CHI_TIET_PHONG_VE } from \"../types/QuanLyDatVeType\";\nimport { thongTinTaiKhoanAction } from \"./QuanLyNguoiDungAction\";\nimport Swal from 'sweetalert2';\nexport const layChiTietPhongVeAction = maLichChieu => {\n  return async dispatch => {\n    try {\n      dispatch({\n        type: DISPLAY_LOADING\n      });\n      const result = await quanLyDatVeService.layChiTietPhongVe(maLichChieu);\n\n      if (result.status === 200) {\n        await dispatch({\n          type: SET_CHI_TIET_PHONG_VE,\n          chiTietPhongVe: result.data.content\n        });\n      }\n\n      dispatch({\n        type: HIDE_LOADING\n      });\n    } catch (error) {\n      console.log('error', error);\n    }\n  };\n};\nexport const datVeAction = thongtinDatVe => {\n  return async (dispatch, getState) => {\n    try {\n      dispatch({\n        type: DISPLAY_LOADING\n      });\n      const result = await quanLyDatVeService.datVe(thongtinDatVe);\n\n      if (result.status === 200) {\n        Swal.fire({\n          text: 'Đặt vé thành công thành công!',\n          icon: 'success',\n          showCancelButton: false,\n          confirmButtonText: 'Ok'\n        }).then(info => {\n          if (info.isConfirmed) {\n            dispatch({\n              type: CHUYEN_TAB\n            });\n          }\n        });\n        ;\n      }\n\n      await dispatch(layChiTietPhongVeAction(thongtinDatVe.maLichChieu));\n      await dispatch({\n        type: DAT_VE_HOAN_TAT\n      });\n      await dispatch({\n        type: HIDE_LOADING\n      });\n      let userLogin = getState().QuanLyNguoiDungReducer.userLogin;\n      connection.invoke('datGheThanhCong', userLogin.taiKhoan, thongtinDatVe.maLichChieu);\n      dispatch(thongTinTaiKhoanAction());\n    } catch (err) {\n      Swal.fire({\n        text: 'Đặt vé thất bại!',\n        icon: 'error',\n        showCancelButton: false,\n        confirmButtonText: 'Ok'\n      }).then(info => {});\n      ;\n    }\n  };\n};\nexport const datGheAction = (ghe, maLichChieu) => {\n  return async (dispatch, getState) => {\n    //đƯA THÔNG TIN LÊN REDUCER\n    await dispatch({\n      type: DAT_GHE,\n      gheDuocChon: ghe\n    }); //call api ve backend\n\n    let danhSachGheDangDat = getState().QuanLyDatVeReducer.danhSachGheDangDat;\n    let taiKhoan = getState().QuanLyNguoiDungReducer.userLogin.taiKhoan; // console.log(\"danhSachGheDangDat\", danhSachGheDangDat);\n    // console.log(\"malichchieu\", maLichChieu);\n\n    danhSachGheDangDat = JSON.stringify(danhSachGheDangDat);\n    taiKhoan = taiKhoan.toString(); //call api signalR\n\n    connection.invoke('datGhe', taiKhoan, danhSachGheDangDat, maLichChieu);\n  };\n};","map":{"version":3,"sources":["C:/Users/ADMIN/Desktop/BaiHocReactjs/moviebooking/src/redux/actions/QuanLyDatVeAction.js"],"names":["connection","quanLyDatVeService","DISPLAY_LOADING","HIDE_LOADING","CHUYEN_TAB","DAT_GHE","DAT_VE_HOAN_TAT","SET_CHI_TIET_PHONG_VE","thongTinTaiKhoanAction","Swal","layChiTietPhongVeAction","maLichChieu","dispatch","type","result","layChiTietPhongVe","status","chiTietPhongVe","data","content","error","console","log","datVeAction","thongtinDatVe","getState","datVe","fire","text","icon","showCancelButton","confirmButtonText","then","info","isConfirmed","userLogin","QuanLyNguoiDungReducer","invoke","taiKhoan","err","datGheAction","ghe","gheDuocChon","danhSachGheDangDat","QuanLyDatVeReducer","JSON","stringify","toString"],"mappings":"AAAA,SAASA,UAAT,QAA2B,aAA3B;AACA,SAASC,kBAAT,QAAmC,kCAAnC;AACA,SAASC,eAAT,EAA0BC,YAA1B,QAA8C,4BAA9C;AACA,SAASC,UAAT,EAAqBC,OAArB,EAA8BC,eAA9B,EAA+CC,qBAA/C,QAA4E,0BAA5E;AACA,SAASC,sBAAT,QAAuC,yBAAvC;AACA,OAAOC,IAAP,MAAiB,aAAjB;AAEA,OAAO,MAAMC,uBAAuB,GAAIC,WAAD,IAAiB;AACpD,SAAO,MAAOC,QAAP,IAAoB;AACvB,QAAI;AACAA,MAAAA,QAAQ,CAAC;AACLC,QAAAA,IAAI,EAAEX;AADD,OAAD,CAAR;AAGA,YAAMY,MAAM,GAAG,MAAMb,kBAAkB,CAACc,iBAAnB,CAAqCJ,WAArC,CAArB;;AACA,UAAIG,MAAM,CAACE,MAAP,KAAkB,GAAtB,EAA2B;AACvB,cAAMJ,QAAQ,CAAC;AACXC,UAAAA,IAAI,EAAEN,qBADK;AAEXU,UAAAA,cAAc,EAAEH,MAAM,CAACI,IAAP,CAAYC;AAFjB,SAAD,CAAd;AAIH;;AACDP,MAAAA,QAAQ,CAAC;AAAEC,QAAAA,IAAI,EAAEV;AAAR,OAAD,CAAR;AACH,KAZD,CAYE,OAAOiB,KAAP,EAAc;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBF,KAArB;AACH;AACJ,GAhBD;AAiBH,CAlBM;AAmBP,OAAO,MAAMG,WAAW,GAAIC,aAAD,IAAmB;AAC1C,SAAO,OAAOZ,QAAP,EAAiBa,QAAjB,KAA8B;AAEjC,QAAI;AACAb,MAAAA,QAAQ,CAAC;AACLC,QAAAA,IAAI,EAAEX;AADD,OAAD,CAAR;AAGA,YAAMY,MAAM,GAAG,MAAMb,kBAAkB,CAACyB,KAAnB,CAAyBF,aAAzB,CAArB;;AACA,UAAIV,MAAM,CAACE,MAAP,KAAkB,GAAtB,EAA2B;AACvBP,QAAAA,IAAI,CAACkB,IAAL,CAAU;AACNC,UAAAA,IAAI,EAAE,+BADA;AAENC,UAAAA,IAAI,EAAE,SAFA;AAGNC,UAAAA,gBAAgB,EAAE,KAHZ;AAINC,UAAAA,iBAAiB,EAAE;AAJb,SAAV,EAKGC,IALH,CAKSC,IAAD,IAAU;AAEd,cAAIA,IAAI,CAACC,WAAT,EAAsB;AAClBtB,YAAAA,QAAQ,CAAC;AACLC,cAAAA,IAAI,EAAET;AADD,aAAD,CAAR;AAIH;AACJ,SAbD;AAaG;AACN;;AACD,YAAMQ,QAAQ,CAACF,uBAAuB,CAACc,aAAa,CAACb,WAAf,CAAxB,CAAd;AACA,YAAMC,QAAQ,CAAC;AAAEC,QAAAA,IAAI,EAAEP;AAAR,OAAD,CAAd;AAGA,YAAMM,QAAQ,CAAC;AAAEC,QAAAA,IAAI,EAAEV;AAAR,OAAD,CAAd;AACA,UAAIgC,SAAS,GAAGV,QAAQ,GAAGW,sBAAX,CAAkCD,SAAlD;AACAnC,MAAAA,UAAU,CAACqC,MAAX,CAAkB,iBAAlB,EAAqCF,SAAS,CAACG,QAA/C,EAAyDd,aAAa,CAACb,WAAvE;AACAC,MAAAA,QAAQ,CAACJ,sBAAsB,EAAvB,CAAR;AAGH,KA/BD,CA+BE,OAAO+B,GAAP,EAAY;AACV9B,MAAAA,IAAI,CAACkB,IAAL,CAAU;AACNC,QAAAA,IAAI,EAAE,kBADA;AAENC,QAAAA,IAAI,EAAE,OAFA;AAGNC,QAAAA,gBAAgB,EAAE,KAHZ;AAINC,QAAAA,iBAAiB,EAAE;AAJb,OAAV,EAKGC,IALH,CAKSC,IAAD,IAAU,CACjB,CAND;AAMG;AAEN;AAEJ,GA5CD;AA6CH,CA9CM;AAgDP,OAAO,MAAMO,YAAY,GAAG,CAACC,GAAD,EAAM9B,WAAN,KAAsB;AAC9C,SAAO,OAAOC,QAAP,EAAiBa,QAAjB,KAA8B;AACjC;AACA,UAAMb,QAAQ,CAAC;AACXC,MAAAA,IAAI,EAAER,OADK;AAEXqC,MAAAA,WAAW,EAAED;AAFF,KAAD,CAAd,CAFiC,CAMjC;;AACA,QAAIE,kBAAkB,GAAGlB,QAAQ,GAAGmB,kBAAX,CAA8BD,kBAAvD;AACA,QAAIL,QAAQ,GAAGb,QAAQ,GAAGW,sBAAX,CAAkCD,SAAlC,CAA4CG,QAA3D,CARiC,CASjC;AACA;;AACAK,IAAAA,kBAAkB,GAAGE,IAAI,CAACC,SAAL,CAAeH,kBAAf,CAArB;AACAL,IAAAA,QAAQ,GAAGA,QAAQ,CAACS,QAAT,EAAX,CAZiC,CAajC;;AACA/C,IAAAA,UAAU,CAACqC,MAAX,CAAkB,QAAlB,EAA4BC,QAA5B,EAAsCK,kBAAtC,EAA0DhC,WAA1D;AACH,GAfD;AAgBH,CAjBM","sourcesContent":["import { connection } from \"../../index\";\r\nimport { quanLyDatVeService } from \"../../service/QuanLyDatVeService\";\r\nimport { DISPLAY_LOADING, HIDE_LOADING } from \"../../util/settings/config\";\r\nimport { CHUYEN_TAB, DAT_GHE, DAT_VE_HOAN_TAT, SET_CHI_TIET_PHONG_VE } from \"../types/QuanLyDatVeType\";\r\nimport { thongTinTaiKhoanAction } from \"./QuanLyNguoiDungAction\";\r\nimport Swal from 'sweetalert2';\r\n\r\nexport const layChiTietPhongVeAction = (maLichChieu) => {\r\n    return async (dispatch) => {\r\n        try {\r\n            dispatch({\r\n                type: DISPLAY_LOADING\r\n            });\r\n            const result = await quanLyDatVeService.layChiTietPhongVe(maLichChieu);\r\n            if (result.status === 200) {\r\n                await dispatch({\r\n                    type: SET_CHI_TIET_PHONG_VE,\r\n                    chiTietPhongVe: result.data.content\r\n                });\r\n            }\r\n            dispatch({ type: HIDE_LOADING });\r\n        } catch (error) {\r\n            console.log('error', error);\r\n        }\r\n    };\r\n};\r\nexport const datVeAction = (thongtinDatVe) => {\r\n    return async (dispatch, getState) => {\r\n\r\n        try {\r\n            dispatch({\r\n                type: DISPLAY_LOADING\r\n            });\r\n            const result = await quanLyDatVeService.datVe(thongtinDatVe);\r\n            if (result.status === 200) {\r\n                Swal.fire({\r\n                    text: 'Đặt vé thành công thành công!',\r\n                    icon: 'success',\r\n                    showCancelButton: false,\r\n                    confirmButtonText: 'Ok',\r\n                }).then((info) => {\r\n\r\n                    if (info.isConfirmed) {\r\n                        dispatch({\r\n                            type: CHUYEN_TAB\r\n                        });\r\n\r\n                    }\r\n                });;\r\n            }\r\n            await dispatch(layChiTietPhongVeAction(thongtinDatVe.maLichChieu));\r\n            await dispatch({ type: DAT_VE_HOAN_TAT });\r\n\r\n\r\n            await dispatch({ type: HIDE_LOADING });\r\n            let userLogin = getState().QuanLyNguoiDungReducer.userLogin;\r\n            connection.invoke('datGheThanhCong', userLogin.taiKhoan, thongtinDatVe.maLichChieu);\r\n            dispatch(thongTinTaiKhoanAction());\r\n\r\n\r\n        } catch (err) {\r\n            Swal.fire({\r\n                text: 'Đặt vé thất bại!',\r\n                icon: 'error',\r\n                showCancelButton: false,\r\n                confirmButtonText: 'Ok',\r\n            }).then((info) => {\r\n            });;\r\n\r\n        }\r\n\r\n    };\r\n};\r\n\r\nexport const datGheAction = (ghe, maLichChieu) => {\r\n    return async (dispatch, getState) => {\r\n        //đƯA THÔNG TIN LÊN REDUCER\r\n        await dispatch({\r\n            type: DAT_GHE,\r\n            gheDuocChon: ghe\r\n        });\r\n        //call api ve backend\r\n        let danhSachGheDangDat = getState().QuanLyDatVeReducer.danhSachGheDangDat;\r\n        let taiKhoan = getState().QuanLyNguoiDungReducer.userLogin.taiKhoan;\r\n        // console.log(\"danhSachGheDangDat\", danhSachGheDangDat);\r\n        // console.log(\"malichchieu\", maLichChieu);\r\n        danhSachGheDangDat = JSON.stringify(danhSachGheDangDat);\r\n        taiKhoan = taiKhoan.toString();\r\n        //call api signalR\r\n        connection.invoke('datGhe', taiKhoan, danhSachGheDangDat, maLichChieu);\r\n    };\r\n};"]},"metadata":{},"sourceType":"module"}